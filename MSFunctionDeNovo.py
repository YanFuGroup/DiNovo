
import numpy as np
from MSData import Candidate, CDataPack
import parameters
from Denovo_functions import build_aa_permutations_file_function,de_novo_initial_path_function,\
    normalized_intensity_function,get_target_value,build_signal_index_function, remove_isotope_peaks


class CFunctionDeNovo:

    def __init__(self, inputDP:CDataPack):

        self.dp = inputDP
        self.aa_permutations_list, \
        self.mass_round_to_index_list, \
        self.mass_round_to_deltamass_list = build_aa_permutations_file_function()

        self.MASS_H = self.dp.myINI.DICT0_ELEMENT_MASS["H"][0]
        self.MASS_O = self.dp.myINI.DICT0_ELEMENT_MASS["O"][0]
        self.MASS_H2O = 2 * self.MASS_H + self.MASS_O
        self.MASS_PEP_ADD = self.dp.myINI.MASS_PROTON_MONO + self.MASS_H2O

        #try_pepmass、lys_pepmass 转换后的单电荷母离子质量
        #try_charge 、lys_charge
        #match_type
        #try_original_mz , lys_original_mz
        #try_original_intensity , lys_original_intensity
        # try_2nd_mz , lys_2nd_mz
        # try_2nd_intensity , lys_2nd_intensity
    def denovo(self, try_pepmass, try_charge, original_try_mz_list, original_try_intensity_list,
               try_mz_2nd_list, try_intensity_2nd_list, try_isotope_cluster, try_isotope_charge,

               lys_pepmass, lys_charge, original_lys_mz_list, original_lys_intensity_list,
               lys_mz_2nd_list, lys_intensity_2nd_list, lys_isotope_cluster, lys_isotope_charge, match_type):
        # try_pepmass = 2075.0765675332304
        # lys_pepmass = 2075.07669953323
        # try_charge = 2
        # lys_charge = 2
        # match_type = 1
        # original_try_mz_list = [101.07078, 101.10673, 101.16274, 102.07504, 110.07101, 115.0866, 119.08134, 121.21284, 123.44586, 128.10661, 129.06548, 129.10202, 130.08643, 132.34509, 145.06075, 147.11263, 155.08124, 157.09708, 167.0925, 172.10803, 173.12842, 183.11241, 184.1171, 185.09171, 195.0871, 196.14409, 197.12799, 200.10275, 200.13998, 201.12299, 209.0905, 209.12741, 209.14046, 212.10329, 214.11819, 214.15495, 224.10356, 224.13899, 225.12247, 226.15477, 227.15764, 229.11829, 230.11305, 230.18146, 231.09514, 231.11638, 236.30258, 237.13313, 240.09802, 242.11319, 242.14937, 243.11964, 243.13345, 244.16513, 245.07672, 245.16867, 259.09146, 259.17676, 266.16684, 269.29572, 270.18124, 283.17514, 284.16132, 294.15631, 295.17682, 298.17548, 308.17227, 309.15445, 311.17081, 312.17459, 313.18661, 314.186, 325.15247, 325.18719, 327.16614, 329.18137, 330.18527, 331.19714, 332.20181, 339.16562, 340.14914, 341.21698, 342.1861, 343.1962, 344.14581, 351.17761, 352.16061, 354.16342, 356.10727, 357.17639, 358.15524, 370.20822, 371.21725, 374.11942, 375.12158, 377.33429, 379.24326, 388.2189, 389.22098, 395.19046, 397.24246, 398.2095, 407.24008, 407.95932, 409.21631, 414.27139, 419.20053, 423.18707, 424.25525, 435.08469, 436.26608, 437.20972, 440.21176, 441.19745, 442.19815, 442.26529, 443.2724, 443.88293, 455.25772, 457.22055, 458.22318, 459.22153, 464.26068, 465.26291, 467.26047, 468.26236, 469.18906, 469.27042, 470.19269, 478.27713, 480.25415, 485.27112, 486.27258, 487.20224, 487.27716, 488.20255, 490.30115, 495.30368, 497.19733, 508.28815, 534.21527, 535.2973, 536.29193, 538.26379, 539.2785, 540.26147, 548.24457, 549.34802, 552.2356, 552.32483, 553.33893, 557.29175, 558.2973, 559.26953, 566.25256, 569.25195, 570.25232, 573.25958, 577.3512, 578.35022, 587.2644, 588.26923, 593.29956, 595.3186, 596.30389, 597.23608, 597.31305, 598.2392, 606.33569, 607.34039, 611.31293, 613.33112, 614.33112, 615.26031, 635.35052, 647.28882, 648.383, 649.32361, 651.2984, 653.28833, 663.35498, 664.35608, 665.34564, 666.36444, 668.31659, 669.29602, 681.28271, 682.29028, 684.36743, 685.36273, 686.33179, 698.29999, 716.31012, 721.42999, 759.42242, 770.35852, 771.28046, 776.44049, 777.43634, 780.349, 787.36133, 794.36975, 797.36938, 797.45441, 798.44922, 815.37994, 816.37665, 817.41925, 819.45807, 829.39917, 835.42096, 836.45532, 837.46136, 847.43848, 854.47144, 855.47491, 856.47485, 876.43475, 883.44073, 886.42572, 887.4649, 889.4325, 893.43469, 894.43732, 904.46313, 905.48822, 906.48248, 910.45062, 911.45575, 922.43567, 923.43951, 928.46246, 929.4624, 930.48645, 935.52411, 950.46161, 951.45001, 953.54053, 954.54138, 955.55499, 967.48865, 985.49164, 986.4812, 999.52448, 1000.46094, 1004.47565, 1005.45465, 1016.52087, 1017.54736, 1020.49158, 1021.49445, 1022.48444, 1023.46863, 1034.53064, 1035.5354, 1038.52698, 1061.49036, 1063.53638, 1072.58594, 1076.53418, 1078.53113, 1090.59961, 1091.60547, 1092.57678, 1094.54797, 1095.54456, 1096.54846, 1104.52295, 1105.54468, 1122.54077, 1123.54285, 1124.54517, 1129.60449, 1131.59631, 1132.54883, 1134.58362, 1147.62, 1148.62622, 1149.54138, 1150.55359, 1151.60571, 1174.57764, 1193.61987, 1194.62073, 1203.59741, 1221.61145, 1222.61414, 1223.65137, 1243.70435, 1245.61487, 1260.70459, 1261.71155, 1262.63965, 1263.63013, 1278.64197, 1279.63806, 1288.94946, 1355.672, 1363.70801, 1364.69971, 1372.65784, 1373.68237, 1374.64355, 1389.7406, 1390.7533, 1391.71655, 1392.73596, 1393.71509, 1462.75415, 1463.75598, 1479.7865, 1480.79443, 1491.76086, 1492.76978, 1518.7793, 1519.80005, 1562.78638, 1572.82349, 1590.81396, 1591.80737, 1592.82849, 1616.80957, 1633.81482, 1634.81116, 1635.81445, 1746.92004, 1747.93567]
        # original_lys_mz_list = [101.07077, 101.07692, 101.10713, 101.36183, 103.95481, 110.07097, 111.07319, 116.07034, 117.06561, 119.08117, 127.08661, 129.06708, 129.10191, 130.10529, 133.11313, 143.11752, 145.06085, 147.07437, 155.08121, 157.09708, 165.65263, 167.09207, 167.11761, 171.11319, 172.10809, 175.168, 183.07599, 183.14897, 185.09154, 185.12825, 186.09583, 186.1312, 195.08755, 195.11278, 195.81412, 197.12814, 197.16463, 200.10246, 200.17532, 201.12141, 203.10214, 204.10461, 208.10773, 209.09174, 210.1593, 211.14409, 212.10257, 212.13724, 214.11827, 214.15611, 223.1069, 224.10268, 228.17014, 230.11322, 231.11423, 237.1346, 242.1129, 242.14865, 243.11653, 259.1752, 260.12363, 267.18134, 270.17966, 276.15842, 283.13693, 293.19351, 294.15689, 298.33081, 301.22308, 308.1713, 311.17172, 311.20746, 313.18619, 325.14954, 325.18588, 329.21762, 335.133, 339.16571, 340.17081, 341.21936, 343.19647, 346.24246, 351.1763, 352.15933, 353.14374, 354.14893, 357.17596, 358.17865, 370.20056, 379.24399, 395.22784, 407.23929, 422.24075, 437.20816, 439.26215, 439.31332, 439.63919, 440.2493, 441.21417, 450.19461, 457.2753, 458.228, 464.26163, 467.22372, 468.23001, 469.27335, 478.27756, 485.23492, 487.20157, 517.01263, 517.28235, 525.33185, 535.29626, 536.28235, 538.27362, 539.25037, 542.3634, 552.32043, 553.33392, 566.25684, 570.36115, 577.34668, 578.34723, 606.33331, 611.30774, 625.82007, 653.28143, 663.35413, 664.35358, 665.31653, 668.35956, 681.29132, 681.85107, 685.3858, 703.86194, 704.37042, 713.54712, 716.31073, 733.39325, 753.38525, 776.43799, 777.42261, 780.35706, 781.33838, 794.36658, 796.42719, 807.44818, 814.43604, 829.39264, 837.38184, 866.31268, 886.49939, 888.45349, 893.42871, 894.43799, 905.49023, 906.48083, 922.43427, 943.47064, 944.47699, 950.45447, 951.46533, 995.47382, 1005.46637, 1011.53833, 1017.53278, 1019.55194, 1020.53113, 1021.49097, 1022.50153, 1023.46973, 1024.46582, 1028.55151, 1029.57202, 1034.52588, 1035.52332, 1038.5293, 1039.52344, 1056.55859, 1057.55396, 1061.49512, 1063.52869, 1078.52161, 1094.53687, 1095.57849, 1096.54956, 1097.56274, 1113.57288, 1114.58008, 1115.52966, 1122.54236, 1123.53589, 1132.60229, 1134.57422, 1149.54724, 1150.55469, 1151.62354, 1179.54883, 1180.57397, 1222.6394, 1223.64294, 1224.68994, 1232.61975, 1233.63757, 1243.68396, 1250.63367, 1251.64441, 1252.59119, 1262.63086, 1263.64514, 1264.67493, 1287.95398, 1290.59094, 1292.65271, 1293.64526, 1321.70544, 1322.7019, 1349.70056, 1350.71265, 1363.70044, 1364.6792, 1372.69641, 1389.73853, 1390.69995, 1391.68994, 1392.69434, 1406.72412, 1465.77759, 1481.46448, 1491.74719, 1492.75623, 1519.80566, 1520.81287, 1563.8302, 1590.83923, 1591.83801, 1592.86914, 1607.90625, 1618.84619, 1619.82324, 1690.87488, 1718.91089, 1719.92297]
        # original_try_intensity_list = [135630.4, 8045.6, 2718.4, 4460.2, 42521.4, 4185.2, 12870.4, 3088.8, 2825.0, 20683.2, 13356.6, 69808.1, 21422.0, 3329.4, 3761.7, 75408.2, 26781.6, 17837.2, 10269.3, 3999.8, 35291.8, 76552.7, 5345.7, 15263.9, 22418.0, 4565.6, 14482.9, 14325.7, 11323.7, 38207.8, 5228.2, 5741.0, 10298.1, 17758.8, 14782.9, 34782.0, 7870.2, 5714.2, 12435.0, 108514.9, 8181.0, 12415.0, 89612.8, 3155.7, 2695.7, 5057.0, 3107.4, 15743.6, 22040.4, 57207.5, 36669.1, 3523.8, 4205.0, 479177.1, 27246.4, 48148.8, 11424.9, 5520.6, 3878.4, 3331.3, 4248.0, 10148.8, 6333.0, 16316.4, 10777.9, 4028.3, 13280.9, 5205.9, 186052.6, 21755.7, 35020.6, 3537.5, 4278.4, 3781.6, 6891.9, 76312.9, 7232.9, 78334.8, 11879.2, 25015.5, 17789.7, 6360.1, 2989.7, 26248.9, 4486.2, 11381.8, 7542.4, 4007.7, 5581.2, 49546.8, 13253.4, 28279.9, 4491.5, 25793.8, 5642.4, 2984.1, 7983.8, 36482.0, 6222.2, 5167.2, 5529.7, 4050.2, 19772.7, 2744.0, 6130.1, 9667.2, 3348.1, 5182.2, 8957.9, 3019.3, 14125.1, 8290.4, 5783.6, 15042.2, 5929.9, 27039.0, 5262.0, 2660.7, 6986.6, 7016.7, 30157.8, 5276.2, 24566.3, 4291.6, 92834.9, 15813.9, 16548.0, 9284.8, 4899.0, 12795.5, 3529.2, 487380.8, 101040.8, 30149.3, 9133.7, 4856.3, 2988.1, 5924.9, 3509.8, 4281.9, 3331.4, 27069.1, 12070.6, 7165.5, 12050.5, 4703.9, 6818.4, 3647.9, 4345.2, 13134.4, 3589.8, 28708.9, 8283.3, 3876.7, 7408.2, 10127.3, 6085.6, 4255.1, 7896.5, 9738.8, 17187.7, 5297.0, 7218.5, 33719.9, 55803.6, 4281.3, 8239.6, 9868.3, 36436.2, 7406.4, 9140.7, 30005.4, 9228.4, 8064.8, 8560.2, 4723.0, 9523.9, 4785.2, 5480.0, 7799.8, 49093.4, 16250.2, 5619.1, 7039.9, 6015.4, 5139.8, 18716.9, 6028.5, 35286.0, 6674.9, 10761.1, 7098.4, 8735.6, 3395.3, 3930.1, 3217.7, 3157.0, 27317.7, 11520.2, 15909.9, 3568.6, 6919.6, 6695.9, 11784.1, 3336.1, 22897.8, 4780.9, 5084.7, 6322.2, 4751.1, 3938.3, 11832.9, 9876.9, 5358.8, 128761.8, 47511.1, 7286.7, 4173.0, 5375.1, 5005.1, 7208.3, 3991.6, 13182.7, 5808.1, 11585.9, 16722.6, 15573.5, 7634.8, 4840.7, 8036.6, 3367.1, 10746.0, 4150.3, 3650.2, 7334.9, 20068.2, 9542.6, 76037.9, 32111.5, 7355.8, 8996.1, 15753.5, 6351.1, 5106.2, 3161.0, 5959.8, 6093.9, 4729.8, 9526.9, 4361.4, 18606.2, 10072.5, 13202.4, 15117.1, 11880.3, 8059.4, 4767.1, 6595.3, 8072.3, 5508.7, 6112.0, 52395.3, 29626.7, 4812.3, 54017.8, 22331.9, 7519.1, 10095.0, 6909.9, 64739.5, 40785.0, 7124.7, 11657.9, 5013.7, 5520.6, 7414.5, 82677.4, 46488.2, 19272.4, 11833.1, 5896.0, 4853.4, 8805.6, 4678.5, 4768.1, 30346.7, 16911.0, 5686.3, 5213.4, 5495.6, 26578.3, 16623.3, 12449.1, 6108.5, 15511.5, 8744.9, 3734.5, 3442.4, 9605.2, 5185.7, 3831.9, 8284.2, 6263.3, 11874.8, 12990.7, 21897.5, 8958.5, 6577.2, 20616.2, 14172.3, 5323.1, 6634.1, 5740.4, 5567.2, 6810.4, 8100.1, 4466.9, 4786.2, 22262.3, 22177.1, 7157.5, 4644.8, 17789.9, 15084.4, 4881.3, 5330.2, 4075.6]
        # original_lys_intensity_list = [12052.8, 2297.5, 15396.5, 2388.4, 2623.7, 83525.0, 2608.2, 66016.1, 19185.5, 13031.2, 8308.3, 3392.4, 190997.8, 11554.5, 2177.9, 7911.0, 10014.7, 3165.0, 58097.8, 7585.2, 2357.4, 9693.7, 4103.4, 7676.9, 6799.9, 2733.8, 3573.6, 30682.3, 100197.2, 19047.5, 4400.2, 2971.4, 8964.4, 8840.6, 2568.9, 4409.2, 9804.0, 15396.4, 12645.7, 3439.3, 105535.7, 5323.3, 5946.3, 9213.1, 16833.7, 4703.6, 11001.5, 4776.1, 21785.0, 3081.3, 2617.7, 14967.3, 30731.7, 61442.0, 2918.9, 5965.4, 266053.2, 15095.5, 26219.4, 4457.2, 30140.2, 7136.4, 10638.1, 3043.1, 4857.5, 7252.0, 12025.9, 2533.0, 5841.8, 8212.3, 6066.4, 6257.7, 6582.8, 14781.1, 2427.1, 22078.9, 4528.1, 48708.8, 4142.3, 6827.0, 19639.7, 5884.8, 5969.6, 10207.6, 20425.2, 3653.7, 202586.6, 26438.1, 11265.7, 6017.2, 3980.3, 9472.7, 6722.9, 5078.3, 3518.0, 2497.8, 3362.0, 15216.2, 4520.0, 4017.2, 4797.5, 8628.3, 14485.5, 28907.2, 4691.5, 6638.2, 6383.0, 10977.8, 5793.9, 3266.9, 2955.9, 3842.5, 11987.8, 6269.8, 4556.6, 3314.3, 17892.8, 4439.7, 10960.0, 4582.5, 14305.2, 6334.8, 3718.8, 10496.9, 5061.3, 6259.5, 3324.6, 16910.0, 5316.5, 8099.1, 3099.8, 6854.3, 2633.7, 14434.0, 4816.6, 7087.3, 2862.3, 4191.6, 2911.3, 2759.5, 6831.7, 5027.1, 7521.5, 5306.9, 7893.0, 4428.7, 4246.7, 6954.2, 6028.9, 7942.3, 2774.9, 3003.7, 5178.3, 12701.3, 4855.0, 6891.6, 12780.0, 6044.5, 23843.0, 10951.8, 15584.0, 6075.8, 7404.7, 5765.9, 4066.3, 4094.1, 3034.5, 3436.0, 18066.5, 10538.8, 14249.5, 8374.8, 5822.9, 4661.0, 9141.3, 10359.3, 7403.0, 6418.8, 23842.2, 12262.2, 3642.0, 9002.6, 4687.2, 4641.9, 4014.8, 6324.5, 3408.9, 36788.9, 21125.2, 4107.3, 20311.7, 7518.5, 4239.9, 5960.8, 17386.8, 6896.6, 4626.4, 9753.8, 3500.5, 13812.4, 7994.8, 3217.4, 5784.8, 5495.9, 3322.7, 34802.8, 18292.1, 4477.5, 14828.9, 6288.7, 4148.5, 3799.8, 3019.7, 7305.8, 5495.7, 5870.1, 7094.5, 20256.4, 14475.7, 9078.3, 5652.2, 4407.7, 2990.2, 9244.7, 3862.9, 3364.8, 10939.8, 3430.3, 2790.1, 15061.9, 11316.4, 13441.3, 9825.9, 4216.4, 16622.5, 14062.1, 4827.9, 4492.0, 3974.4, 5247.9, 3117.1, 14016.7, 13081.3]
        # try_mz_2nd_list = [147.11263, 155.08124, 173.12842, 195.0871, 201.12299, 230.11305, 242.11319, 244.16513, 329.18137, 331.19714, 357.17639, 388.2189, 442.26529, 458.22318, 485.27112, 487.20224, 552.32483, 557.29175, 577.3512, 587.2644, 606.33569, 613.33112, 663.35498, 684.36743, 716.31012, 776.44049, 780.349, 797.45441, 815.37994, 819.45807, 854.47144, 893.43469, 905.48822, 950.46161, 953.54053, 985.49164, 1034.53064, 1038.52698, 1090.59961, 1094.54797, 1122.54077, 1147.62, 1149.54138, 1193.61987, 1221.61145, 1260.70459, 1262.63965, 1278.64197, 1363.70801, 1372.65784, 1389.7406, 1391.71655, 1479.7865, 1491.76086, 1518.7793, 1562.78638, 1590.81396, 1633.81482, 1746.92004]
        # lys_mz_2nd_list = [116.07034, 119.08117, 155.08121, 185.12825, 203.10214, 228.17014, 230.11322, 242.1129, 343.19647, 346.24246, 353.14374, 357.17596, 407.23929, 457.2753, 464.26163, 485.23492, 542.3634, 552.32043, 570.36115, 577.34668, 606.33331, 663.35413, 665.31653, 685.3858, 776.43799, 780.35706, 781.33838, 794.36658, 814.43604, 829.39264, 837.38184, 893.42871, 905.49023, 943.47064, 950.45447, 995.47382, 1021.49097, 1023.46973, 1034.52588, 1056.55859, 1113.57288, 1122.54236, 1149.54724, 1179.54883, 1222.6394, 1250.63367, 1262.63086, 1292.65271, 1321.70544, 1349.70056, 1363.70044, 1390.69995, 1406.7202, 1465.77759, 1481.46448, 1491.74719, 1519.80566, 1563.8302, 1590.83923, 1607.90625, 1618.84619, 1690.87488, 1718.91089]
        # try_intensity_2nd_list = [47.75794, 17.71552, 20.82137, 15.88927, 40.32842, 38.96667, 30.03341, 94.84128, 63.52052, 41.81221, 31.39809, 31.60198, 22.74758, 28.49261, 100.0, 27.03961, 25.93016, 26.32646, 13.60896, 21.9415, 23.53275, 43.17333, 29.26065, 25.02671, 12.64397, 21.98642, 12.68611, 12.24054, 20.50926, 5.10817, 53.14263, 14.29223, 22.19857, 18.80506, 40.80235, 19.35419, 19.5805, 21.30424, 34.70283, 34.55727, 41.96029, 43.79218, 19.35594, 11.26145, 25.86273, 23.34042, 16.59719, 16.68307, 12.04987, 10.3721, 16.93786, 21.53246, 24.38483, 9.80864, 12.11947, 0.0, 27.02153, 23.09776, 8.33439]
        # lys_intensity_2nd_list = [45.74528, 27.40195, 42.81433, 28.01612, 83.61409, 40.52157, 48.97963, 100.0, 25.53356, 29.07343, 29.43385, 95.75259, 15.46367, 26.45718, 20.08596, 37.2805, 25.31987, 28.74676, 19.93829, 16.06758, 16.51359, 25.63586, 13.93191, 22.4359, 12.35122, 13.23497, 10.12765, 13.6873, 17.37072, 11.23551, 13.74621, 22.45234, 27.26157, 32.69846, 25.27095, 13.08952, 29.43291, 29.31288, 23.82943, 39.56261, 47.7254, 28.99807, 26.91883, 19.05484, 25.36637, 45.15368, 24.91681, 18.6613, 18.804, 32.66702, 20.2849, 24.76009, 26.02748, 6.40734, 4.47974, 28.16548, 26.29281, 8.1745, 33.05625, 8.70958, 15.19595, 5.54862, 28.58122]

        assert len(try_isotope_cluster) == len(try_isotope_charge) == len(original_try_mz_list) == len(
            original_try_intensity_list)
        assert len(lys_isotope_cluster) == len(lys_isotope_charge) == len(original_lys_mz_list) == len(
            original_lys_intensity_list)

        original_try_mz_list, original_try_intensity_list, \
        original_lys_mz_list, original_lys_intensity_list, = remove_isotope_peaks(
            original_try_mz_list, original_try_intensity_list, original_lys_mz_list, original_lys_intensity_list,
            try_isotope_cluster, try_isotope_charge, lys_isotope_cluster, lys_isotope_charge)
        original_try_mz_np = np.array(original_try_mz_list)
        original_lys_mz_np = np.array(original_lys_mz_list)
        original_try_intensity_np = np.array(original_try_intensity_list)
        original_lys_intensity_np = np.array(original_lys_intensity_list)

        try_mz_2nd_np = np.array(try_mz_2nd_list)
        lys_mz_2nd_np = np.array(lys_mz_2nd_list)
        try_intensity_2nd_np = np.array(normalized_intensity_function(try_intensity_2nd_list))

        delta_mass_target, sum_mass_target = get_target_value(try_pepmass, lys_pepmass, match_type)
        try_signal_N_index_dict, try_signal_C_index_dict = build_signal_index_function(try_mz_2nd_np, lys_mz_2nd_np,
                                                                                       delta_mass_target,
                                                                                       sum_mass_target)

        result_path, result_aa_score, result_seq_score = de_novo_initial_path_function(try_signal_N_index_dict ,
                                                                                         try_signal_C_index_dict ,
                                                                                         try_mz_2nd_np, try_intensity_2nd_np,
                                                                                         original_try_mz_np,
                                                                                         original_lys_mz_np,
                                                                                         original_try_intensity_np,
                                                                                         original_lys_intensity_np,
                                                                                         try_pepmass,
                                                                                         self.aa_permutations_list ,
                                                                                         self.mass_round_to_index_list ,
                                                                                         self.mass_round_to_deltamass_list,
                                                                                         match_type ,try_charge, lys_charge)

        candidate_info = Candidate()
        candidate_info.SEQUENCE= result_path
        # candidate_info.MODIFICATION = []
        candidate_info.SEQUENCE = [""] * len(result_path)
        candidate_info.MODIFICATION = [""] * len(result_path)
        for i, seq_list in enumerate(result_path):
            tmpSeq = "".join([t[0] for t in seq_list])
            tmpCheck = "".join(seq_list)
            if tmpSeq == tmpCheck:
                candidate_info.MODIFICATION[i] = ""
            else:
                tmpMod = ""
                for j, aas in enumerate(seq_list):
                    if len(aas) > 1:
                        tmpMod += str(j+1) + "," + aas[1:] + ";"
                candidate_info.MODIFICATION[i] = tmpMod

            candidate_info.SEQUENCE[i] = tmpSeq

        candidate_info.CALCMASS = [self.MASS_PEP_ADD + sum([parameters.aa_to_mass_dict[x] for x in pep]) for pep in result_path]
        candidate_info.AASCORE = result_aa_score
        candidate_info.PEPSCORE = result_seq_score

        # print(candidate_info)

        return candidate_info













                









                        
